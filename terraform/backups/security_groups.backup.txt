# // Security Group for ALB (allows http and https)

# resource "aws_security_group" "alb_sg" {
#   #   name   = "alb_sg"
#   name = var.alb_sg_name

#   # vpc_id = aws_vpc.mindful-motion-vpc-M.id //old reference

#   vpc_id = module.vpc.vpc_id

#   tags = {
#     Name = var.alb_sg_name
#   }
# }

# resource "aws_vpc_security_group_ingress_rule" "http" {
#   security_group_id = aws_security_group.alb_sg.id
#   #   cidr_ipv4         = "0.0.0.0/0"
#   cidr_ipv4   = var.allow_all_cidr
#   from_port   = var.http_port //80
#   ip_protocol = "tcp"
#   to_port     = var.http_port
# }

# //HTTPS RULE
# resource "aws_vpc_security_group_ingress_rule" "HTTPS_RULE" {
#   security_group_id = aws_security_group.alb_sg.id
#   cidr_ipv4         = var.allow_all_cidr
#   from_port         = var.https_port //443
#   ip_protocol       = "tcp"
#   to_port           = var.https_port
# }

# //OUTBOUND RULE (ALLOW ALL TRAFFIC)
# resource "aws_vpc_security_group_egress_rule" "allow_all_traffic_ipv4" {
#   security_group_id = aws_security_group.alb_sg.id
#   cidr_ipv4         = var.allow_all_cidr
#   ip_protocol       = "-1" # semantically equivalent to all ports
# }


# //ECS SECURITY GROUP allows traffic from alb

# resource "aws_security_group" "ecs_sg" {
#   name = var.ecs_sg_name

#   # vpc_id = aws_vpc.mindful-motion-vpc-M.id //old reference

#   vpc_id = module.vpc.vpc_id



#   tags = {
#     Name = var.ecs_sg_name
#   }
# }

# resource "aws_vpc_security_group_ingress_rule" "allow_tls_ipv4" {
#   security_group_id            = aws_security_group.ecs_sg.id
#   referenced_security_group_id = aws_security_group.alb_sg.id // this is to allow traffic from  alb sg
#   from_port                    = var.app_port                 //3000
#   ip_protocol                  = "tcp"
#   to_port                      = var.app_port
# }


# resource "aws_vpc_security_group_egress_rule" "allow_all_traffic_ipv4_2" {
#   security_group_id = aws_security_group.ecs_sg.id
#   cidr_ipv4         = var.allow_all_cidr
#   ip_protocol       = "-1" # semantically equivalent to all ports
# }
